(()=>{"use strict";const e=[{component:"model",attributes:["lightmapped","lightmapSizeMultiplier","castShadowsLightMap","lightMapped","lightMapSizeMultiplier","isStatic","layers","batchGroupId"]}];let t;function o(e){let t=[];for(let o in e.components)e.components.hasOwnProperty(o)&&(e.components[o].enabled?d(o,e.components[o]):t.push(o));if(t.forEach((t=>{delete e.components[t]})),e.components&&e.components.script){let t=e.components.script.scripts;e.components.script=t;for(let e in t){let o=t[e],i=o.attributes;n(i),o=i,t[e]=o}}else for(let t in e.components)e.components.hasOwnProperty(t)&&n(e.components[t]);e.template_id&&delete e.template_id,e.template_ent_ids&&delete e.template_ent_ids,e.tags&&0===e.tags.length&&delete e.tags,e.children&&0===e.children.length&&delete e.children,e.hasOwnProperty("enabled")&&e.enabled&&delete e.enabled,0===e.position[0]&&0===e.position[1]&&0===e.position[2]&&delete e.postion,0===e.rotation[0]&&0===e.rotation[1]&&0===e.rotation[2]&&delete e.rotation,1===e.scale[0]&&1===e.scale[1]&&1===e.scale[2]&&delete e.scale,e.components&&0===Object.keys(e.components).length&&delete e.components,delete e.parent,delete e.resource_id,e.position&&(e.position[0]=parseFloat(e.position[0].toFixed(4)),e.position[1]=parseFloat(e.position[1].toFixed(4)),e.position[2]=parseFloat(e.position[2].toFixed(4))),e.rotation&&(e.rotation[0]=parseFloat(e.rotation[0].toFixed(4)),e.rotation[1]=parseFloat(e.rotation[1].toFixed(4)),e.rotation[2]=parseFloat(e.rotation[2].toFixed(4))),e.scale&&(e.scale[0]=parseFloat(e.scale[0].toFixed(4)),e.scale[1]=parseFloat(e.scale[1].toFixed(4)),e.scale[2]=parseFloat(e.scale[2].toFixed(4))),e.children&&e.children.forEach((e=>o(e)))}function n(e){let t=[];for(let n in e)if(e.hasOwnProperty(n))if(Array.isArray(e[n]))e[n]=e[n].map((e=>{if(r(e)){let t=i(e);return t&&("json"!==l(e)&&"material"!==l(e)?t=s(t):"json"!==a(t)&&(t=`${t}.json`)),t}return e}));else if(r(e[n])){let t=i(e[n]);t&&("json"!==l(e[n])&&"material"!==l(e[n])?t=s(t):"json"!==a(t)&&(t=`${t}.json`)),e[n]=t}else o=e[n],1===`${o}`.match(/[\d|\w]{8}-[\d|\w]{4}-4[\d|\w]{3}-[\d|\w]{4}-[\d|\w]{12}/)?.length&&t.push(n);var o;t.forEach((t=>delete e[t]))}function i(e){let t=editor.assets.get(e);return t?t.json().name:null}function a(e){return e.split(".").pop()}function l(e){let t=editor.assets.get(e);return t?t.json().type:null}function s(e){return e.replace(/\.[^/.]+$/,"")}function r(e){return 1===`${e}`.match(/[\d]{8,10}/)?.length}function d(o,n){if("script"!==o)for(let e in n)n.hasOwnProperty(e)&&(t||(t=editor.entities.create(),t.addComponent("model"),t.addComponent("render"),t.addComponent("collision"),t.addComponent("rigidbody"),t.addComponent("animation"),t.addComponent("camera"),t.addComponent("light"),t.addComponent("element"),t.addComponent("particlesystem"),t=t.json()),t).components[o][e]===n[e]&&delete n[e];e.forEach((e=>{e.component===o&&e.attributes.forEach((e=>{delete n[e]}))}))}window.addEventListener("FIND_ENTITY",(function(e){let t=e.detail.method,o=e.detail.value;switch(t){case"tag":!function(e){let t=editor.entities.root.listByTag(e.split(","));0!==t.length?(editor.selection.clear(),t.forEach((e=>editor.selection.add(e))),window.dispatchEvent(new CustomEvent("FIND_ENTITY_RESULT",{detail:t.length}))):console.log(`No entities found with tag: ${tag}`)}(o);break;case"name":!function(e){let t=editor.entities.list().filter((t=>t.viewportEntity.name===e));0!==t.length?(editor.selection.clear(),t.forEach((e=>editor.selection.add(e))),window.dispatchEvent(new CustomEvent("FIND_ENTITY_RESULT",{detail:t.length}))):console.log(`No entities found with name: ${e}`)}(o);break;case"regex":!function(e){let t=editor.entities.list().filter((t=>t.viewportEntity.name.match(e)));0!==t.length?(editor.selection.clear(),t.forEach((e=>editor.selection.add(e))),window.dispatchEvent(new CustomEvent("FIND_ENTITY_RESULT",{detail:t.length}))):console.log(`No entities found with regex: ${e}`)}(o);break;default:return void console.error("Invalid find method")}})),window.addEventListener("EXPORT_ENTITIES",(function(e){!function(e=!0,t=!1){let n,i=editor.selection.items;if(0!==i.length){if(1===i.length)n=e?i[0].jsonHierarchy():i[0].json(),o(n),n=JSON.stringify(n);else{let t=[];i.forEach((n=>{let i=e?n.jsonHierarchy():n.json();o(i),t.push(i)})),n=JSON.stringify(t)}t?function(e,t,o){let n=new Blob([e],{type:"application/json"});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(n,t);else{let e=document.createElement("a"),o=URL.createObjectURL(n);e.href=o,e.download=t,document.body.appendChild(e),e.click(),setTimeout((function(){document.body.removeChild(e),window.URL.revokeObjectURL(o)}),0)}}(n,`${1===i.length?i[0].viewportEntity.name:"export"}.json`):(!function(e){let t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.focus(),t.select(),document.execCommand("copy"),document.body.removeChild(t)}(n),alert("Copied to clipboard"))}else alert("No entities selected")}("hierarchy"===e.detail.exportType,e.detail.downloadFile)}))})();
//# sourceMappingURL=injectedScript.js.map